import Crypto
from Crypto.PublicKey import RSA
from Crypto.Cipher import AES
from Crypto import Random
import ast
import datetime

AES_IV = 'IV13579IV2468IV1'     # 128 Bit Initialisierungsvektor

#decrypted code below

f = open('/home/admiral-helmut/Projekte/SaferWeb/KeyServer/LogKeys/1712017.pem', 'r')
message = f.read()
print "AES Key:"
print message

encryptedKey = '\xa6\x86\xe6\xadZ06\xe9@\xff$&\xb5\x11r\xf4\xed\xa9\xc4*\x1b\x85\xe2\xb0\xda\xac,\xfd\xf1\x90{\xdf\xae3\xe6Lm\xeb\xa2\xb6h\xe70s\xecs$\xa9(K+\xde\x9c\xe8\xa3\x18\xc8\x91,t\x1cE>\x15\x19-\x06FP\xdd\x1a\xd4Z\xb6\x07\xb0\xbd\xbb|\xb8\xdc$\xe4A\xe7o\xb0\x92\xc7<\xd63\x1d \xd2\x86\xb6\xb8\xbf:[\xa9m\xf4\xc4P\xb0>\xc2\xfdF\x9e\xe2\xa3st\xbf\xf7\xa0qPK\xae\x01\xb8\x13\x12c\xc8/\xf9\xdd\xc6\xad\x81H\xb2\x10\x9dg\xbe\x99\x16r\x97\x9cs\xb0\xf4\xff\xe7\xae$\x90o\xcf1\xe75\xb2\x19W\x1e\x02qZ0Y\x80\xd9uo0t\xf3\x80\xe2\xeb\x88\x80\xb2\xe64~\xe4\xa7\xdf\x01,\xf4m?\xef\x95\xa9\xc7u\x19e\xf3\x8c\xf3#\xb4m\x06\x9f\xef\xd9\x0e\xf4\x02\xf3\xbe\xb6\x06\x8e\x10_!L\xb5\xa8~\x93\xd3\x07\xc2\xc3\x7f\xf6\x14D\xac\xda\xaa\xbc\x03p\x18\xa3\x87\xe0C\xff\x91\x8d\xf5\x12\xff\t&96\xa9r'

f = open('/home/admiral-helmut/Projekte/SaferWeb/masterKey/privateMasterKey.pem','rb')
key = RSA.importKey(f.read())
decrypted = key.decrypt(str(encryptedKey))
#decrypted = key.decrypt(ast.literal_eval(str(message)))

print decrypted


 #Decryption AES
decryption_suite = AES.new(decrypted, AES.MODE_CBC, AES_IV)
f = open('/home/admiral-helmut/Projekte/SaferWeb/Log/17120172038777962.txt', 'r')
messageLog = f.read()
plain_text = decryption_suite.decrypt(messageLog)

print "LogMessage:"
print plain_text
